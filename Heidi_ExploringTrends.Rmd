---
title: "Heidi_ExploringTrends"
author: "Heidi Erfourth and Zoe Schroder"
date: "2023-07-25"
output: html_document
---

“Exploring trends in tornado outbreak environments and greenhouse gas concentrations” 

`Pursue publication:` International Journal of Climatology
                      https://mc.manuscriptcentral.com/joc 

**Make sure to follow the Author Resources for publication in the Journal. This includes page formatting, section headers, figure format, table format, figure/table location in manuscript, etc.**

```{r}
# Do not need to do these everytime. Once installed on your computer you are finished. 
#install.packages("dplyr")
#install.packages("ggplot2")
#install.packages("tidyverse")
#install.packages("tmap")
#install.packages("devtools")
#devtools::install_github("ropensci/USAboundaries")
#devtools::install_github("ropensci/USAboundariesData")
#install.packages("gridExtra")
```

```{r}
library("dplyr")
library("ggplot2")
library("tmap")
library("USAboundaries")
library("sf")
library("gridExtra")
```

DATA & METHODS
Tornado Clusters 
  Setup Data to produce a clustering with Space-Time Distances

  Needs (numbers for table): 
  1. Number of Days
  2. Number of Groups
  3. Number of Tornadoes
  4. Number of Casualties

`You need to load the data before you can do anything. Do this:`
```{r}
load("TornadoOutbreaks.RData")
```


Cluster: >= 10 tornadoes `This is already done for you. This is the BigDays.sfdfT data`
```{r}
BigDays.sfdfT[,-80]%>% #What is the -80 for?
  group_by(cDate)%>%
  filter(nT>=10)
```
  
  Create a figure (Map) with multiple clusters on a single day
  
`If you are wanting to find a day that has more than one cluster, do this: `
```{r}
BigDays.sfdfT %>% # Cluster Data
  group_by(cDate) %>% # Group by the convective days to see if there are duplicates.
  summarize(num_of_clusters = n()) %>% # Count the number of clusters on each cDate.
  arrange(desc(num_of_clusters)) # Arrange the number of clusters column in descending order. 
```
  
  
  Things that need to be accomplished with said figure
  - creating clustering `This is already done for you. You are doing the same thing that I did in my code. Follow that as an example. You just need to pick which outbreak you want to show.`
  - creating a line around the clustering area `The clustering area is already computed. If you plot the specific outbreak you want from the BigDays.sfdfT it will plot the clustering area. Again reference my code for a figure similar to this.`

## Greenhouse Gas Emissions Data
  Value Selection for each Lag (Table Values)
  Needs:
  Average Emissions per year for CO2, CH4, SF6, N2O, and O3

```{r}
#need to read in the data for the excel file
AnnGHG <- read.csv("AnnualAverages_GHG.csv")

#validating that data looks correct and is the right dimensions
# dim(AnnGHG)
# str(AnnGHG)
```

*Here is the code to rename a column in R: * Fixing the typo in the excel file zero to O
```{r}
colnames(AnnGHG)[colnames(AnnGHG) == "N20_ppb"] = "N2O_ppb"
```

Calculating the Average Emissions per Year (for Table)
```{r}
#Calculating CO2 annual average
CO2_Average <- mean(AnnGHG$CO2_ppm) # This is not by year. This is total for the entire dataset (i.e., average emission between 1994 and 2022). 
print(CO2_Average) # You do not need to use the print function. Just type CO2_Average


 #If you want yearly average of emissions, do this: 
AnnGHG %>%
  group_by(year) %>%
  summarize(avgCO2 = mean(CO2_ppm, na.rm = TRUE),
            avgCH4 = mean(CH4_ppb, na.rm = TRUE) 
            #etc....
            )
```

`See code chunk above. The same applies to the code below: `
```{r}
#Calculating CH4 annual average 
CH4_Average <- mean(AnnGHG$CH4_ppb, na.rm =TRUE) # it would give me NA if I did not use the na.rm function
print(CH4_Average) # See above

#Calculating SF6 annual Average
SF6_Average <- mean(AnnGHG$SF6_ppt, na.rm = TRUE)
print(SF6_Average) # See above

#Calculating N20 annual average
N2O_Average <- mean(AnnGHG$N2O_ppb, na.rm = TRUE)
print(N2O_Average) # See above

#Calculating O3 annual Average
O3_Average <- mean(AnnGHG$O3_DU, na.rm=TRUE)
print(O3_Average) # See above
```

## RESULTS
Spatial Distribution of Tornado Outbreaks in Contiguous US 
  
Needs:
- Map of US with compass and scale
- Plotting Outbreaks (NOT individual Tornadoes)

```{r}
#Reading in T-Outbreaks Data
load("TornadoOutbreaks.RData")
#dim(BigDays.sfdfT)
```
NOTE: These are only for the years 1994 to 2022. Moving forward, you will only use CO2, CH4, O3, and AGGI. N2O and SF6 are excluded because the data does not extend back to 1994. 

```{r}
#getting State Borders for contiguous United States
sts <- state.name[!state.name %in% c("Alaska", "Hawaii")] #Removes AK and HI from list of states
stateBorders <- us_states(states = sts) 
```


`You do not need to do this step. You should use the BigDayCentroids.df. This is the central point of the outbreak which will give the best representation of where the outbreaks occurred. Changing the coordinates of BigDays.sfdfT is probably why you are having errors later in the code.`
```{r, eval = FALSE}
#creating data frame with the starting Latitude and Longitude of the outbreak
coordinate <- BigDays.sfdfT["Lat","Lon"]
BigDays.sf.dfT <- st_as_sf(BigDays.sfdfT)
```

`Use BigDayCentroids.df instead.`
```{r}
#creating map with outbreak data
tm_shape(stateBorders, projection = "+proj=merc +lon_0=0 +k=1 +x_0=0 +y_0=0 +ellps=WGS84 +datum=WGS84 +units=m   +no_defs")+
  tm_borders(col ="gray", alpha = 1)+
  tm_compass(text.size = 1, 
             lwd = 2, 
             color.dark = "gray")+
  tm_scale_bar(width = .3, 
               text.size = 0.8, 
               lwd = 1.75, 
               color.dark = "gray")+
  tm_layout(title="Tornado Outbreaks from 1994-2022", title.position=c("center", "top"), attr.position = c("left","bottom"), inner.margins = c(.1, .1, .1, .1))+
tm_shape(BigDays.sf.dfT, is.master = TRUE, projection = "+proj=merc +lon_0=0 +k=1 +x_0=0 +y_0=0 +ellps=WGS84 +datum=WGS84 +units=m +no_defs" )+
  tm_bubbles(size = 0.1, 
             col = "navyblue")

#The only thing I am stuck with here is why the map is shifted to the left and not centered. The West is getting cut off. 

``` 
`The map is shifted because you have the master set to the BigDays data instead of the stateBorders. Set stateBorders to master and it will fix the issue. Put "is.master = TRUE, " in the tm_shape for stateBorders and remove it from the tm_shape for BigDays.`

Annual Change in Tornado Outbreaks
Needs:
- Year
- Total count of Outbreak within that year

```{r}
#creating grouping for number of outbreaks per year
T_yr <- BigDays.sfdfT[,-80]%>% # Don't need: [,-80]
  group_by(Year)%>%
  summarize(T_Year = n())

#creating a line graph for T-outbreaks per year (probably won't need this one, but I did both incase we wanted to pick one or the other)
ggplot(T_yr)+
  geom_line(aes(x=Year, y=T_Year), color="plum3", linewidth=1)+
  ggtitle("Total Tornado Outbreaks Per Year")+
  theme_bw()+
  theme(plot.title=element_text(hjust=0.5))+
  xlab("Year")+
  ylab("Number of Tornado Outbreaks per Year")+
  scale_x_continuous(expand = c(0,0),limits=c(1994,2022), breaks=seq(1994,2022,2))+
  scale_y_continuous(expand = c(0,0),limits=c(20,50),  breaks=seq(20,50,5))
```

```{r}
#creating a bar graph with regression line for T-Outbreaks per year
ggplot(T_yr, aes(x=Year, y=T_Year))+
  geom_bar(stat="identity",position = "stack",  fill="plum3", width=0.9)+
  stat_smooth(method = "lm", formula = y~x, geom="smooth", color="black", linewidth=1.5)+
  ggtitle("Total Outbreaks Per Year")+
  theme_bw()+
  theme(plot.title=element_text(hjust=0.5))+
  xlab("Year")+
  ylab("Number of Tornado Outbreaks")+
  scale_x_continuous(expand=c(0,0), limits=c(1994,2022), breaks=c(seq(1994, 2022, 2)))+
  scale_y_continuous(expand=c(0,0), limits=c(0,50), breaks=c(seq(0,50,5)))

```
*slightly positive regression line, therefore outbreaks are on the rise.*

Annual Change in GHG Emissions
Needs:
-Year
-Emission Values for that Year
-Regression Line showing overall trend

*creating individual annual trend charts for CO2, CH4, O3, AGGI*

`Make these line graphs instead. I do not like the bar graph.`

`You need to pick a single color to represent each variable. You are using too many colors to represent the same data. Assign CO2 a color and that is the only color you will use for CO2 in the figures, etc. `

CO2 Annual Trend Analysis Chart
```{r}  
ggplot(AnnGHG, aes(x=year, y=CO2_ppm))+
  geom_bar(stat="identity",position = "stack",  fill="orange", width=0.9)+
  stat_smooth(method = "lm", formula = y~x, geom = "smooth", color="black",linewidth=1.5)+
  ggtitle(bquote("Annual Average of Carbon Dioxide CO"[2]))+
  theme_bw()+
  theme(plot.title=element_text(hjust=0.5))+
  xlab("Year")+
  ylab("Concenration (ppm)")+
  scale_x_continuous(expand=c(0,0), limits=c(1955,2025), breaks=c(seq(1960,2025,10)))+
  scale_y_continuous(expand=c(0,0), limits=c(0,500), breaks=c(seq(0,500,50)))
```
  *Positive regression line, values are on the rise*
  
CH4 Annual Trend Analysis Chart
```{r}  
ggplot(AnnGHG, aes(x=year, y=CH4_ppb))+
  geom_bar(stat="identity",position="stack",  fill="pink", width=0.9)+
  stat_smooth(method = "lm", formula = y~x, geom="smooth", color="black", linewidth=1.5)+
  ggtitle(bquote("Annual Average of Methane CH"[4]))+
  theme_bw()+
  theme(plot.title=element_text(hjust=0.5))+
  xlab("Years Recorded")+
  ylab("CH4 (ppb)")+
  scale_x_continuous(expand=c(0,0), limits=c(1980,2025), breaks=c(seq(1980, 2025, 10)))+
  scale_y_continuous(expand=c(0,0), limits=c(0,2000), breaks=c(seq(0,2000,100)))
```
  *Positive regression line, values are on the rise*
  
Got rid ofthe N20 and SF6 charts because their data does not go back to 1994
  
O3 Annual Trend Analysis Chart  
```{r}
#DU = Dobson Units
ggplot(AnnGHG, aes(x=year, y=O3_DU))+
  geom_bar(stat="identity",position = "stack",  fill="maroon", width=0.9)+
  stat_smooth(method = "lm", formula= y~x, geom = "smooth", color="black", linewidth=1.5)+
  ggtitle(bquote("Annual Average of Ozone O"[3]))+
  theme_bw()+
  theme(plot.title=element_text(hjust=0.5))+
  xlab("Years Recorded")+
  ylab("03 (DU)")+
  scale_x_continuous(expand=c(0,0), limits=c(1975,2025), breaks=c(seq(1975, 2025, 4)))+
  scale_y_continuous(expand=c(0,0), limits=c(0, 250), breaks=c(seq(0,250, 25)))
```
  *Negative regression line, values are decrease. However, has the most variation throughout the years*
  
AGGI Annual Trend Analysis Chart
```{r}
ggplot(AnnGHG, aes(x=year, y=AGGI))+
  geom_bar(stat="identity",position = "stack",  fill="blue", width=0.9)+
  stat_smooth(method = "lm", formula = y~x, geom="smooth", color="black", linewidth=1.5)+
  ggtitle("Annual Average for Annual Greenhouse Gas Index (AGGI)")+
  theme_bw()+
  theme(plot.title=element_text(hjust=0.5))+
  xlab("Years Recorded")+
  ylab("AGGI")+
  scale_x_continuous(expand=c(0,0), limits=c(1975,2025), breaks=c(seq(1975, 2025, 4)))+
  scale_y_continuous(expand=c(0,0), limits=c(0,2), breaks=c(seq(0,2,0.1)))

```
 *Positive regression line, values are on the rise*
 
 `If you assign the figures above to an object, you can use a function to combine them into a single plot:`
```{r}
grid.arrange(plotname1, plotname2, plotname3, plotname4, nrow = 2)
```
 `This plot is fine for showing the trends with regards to all data that is available. No value when comparing to the Tornado Outbreaks.`

*Combining the Annual Average Charts into a 4x4 grid*

`make these plots as line graphs using ggplot like you did above. Keep the colors consistent for the GHG variables. Make regression line black.`
```{r}
CO2_avg <- qplot(Year, CO2_1year, data = BigDays.sfdfT)+
  stat_smooth(method = "lm", formula = y~x, geom = "smooth", color="darkturquoise", linewidth=1.5)+
  theme_bw()+
  ylab("Average of CO2")
CH4_avg <- qplot(Year, CH4_1year, data = BigDays.sfdfT)+
  stat_smooth(method = "lm", formula = y~x, geom = "smooth", color="plum3", linewidth=1.5)+
  theme_bw()+
  ylab("Average of CH4")
O3_avg <-  qplot(Year, O3_1year, data = BigDays.sfdfT)+
  stat_smooth(method = "lm", formula = y~x, geom = "smooth", color="pink3", linewidth=1.5)+
  theme_bw()+
  ylab("Average of O3")
AGGI_avg<- qplot(Year, AGGI_1year, data= BigDays.sfdfT)+
  stat_smooth(method = "lm", formula = y~x, geom = "smooth", color="seagreen3", linewidth=1.5)+
  theme_bw()+
  ylab("Average of AGGI")

grid.arrange(CO2_avg, CH4_avg, O3_avg, AGGI_avg, nrow=2,ncol=2, top ="Annual Averages of Greenhouse Gas Emissions")
```
  *Slightly confused here because the regression line of O3 is positive when the regression line for the individual one was negative. The 4x4 is using the BigDays Data because I tried using the AnnGHG but it kept giving me a mapping error*
  
`The figures that you did previously is for all data prior to 1994. The figures that you did in this code chunk are for 1993 to 2021 (1-year prior avg so 1993 data for 1994 avg, 1994 data for 1995 avg, etc.). This is why there is a difference. For 1-year average values, you only want to look at 1993 to 2022. For 5-year average, you want 1989 to 2021. For 10-year average, you want 1983 to 2021. So, if you remove all years prior to 1993 above, the regression line flips to a positive trend. For this research, you should focus only on the values in the BigDays.sfdfT when comparing it to the tornado data.`

10-year averages (Table)
*The 10 year averages are already calculated for you. They are in the BigDays.sfdfT file found in the TornadoOutbreaks.RData*
**The avg for 1994 is 1984 - 1994 not inclusive. Meaning it includes the data for years January 1984 through December 1993.**

Need to get the the 10 year values for the 90s, 00s, 10s, and 20s for the table
*I don't think I need the charts below*

Grouping CO2 10 averages
`Unnecessary. Just use the BigDays.sfdfT object.`
```{r}
#First: Get the 10-year average value for each year 1994 - 2022

#CO2 10 year averages
CO2 <- BigDays.sfdfT[,-80] %>%
  group_by(Year) %>%
  summarize(CO2_10yr = max(CO2_10year))
```

CO2 10-year averages trend

```{r}
#Second: Make the plot!
ggplot(CO2) + # Change this!
# ggplot(BigDays.sfdfT) +
  geom_line(aes(x = Year, y = CO2_10yr), 
            color = "red",
            linewidth = 1)  +
  theme_bw() +
  xlab("Year") +
  ylab("10-year Average CO2 Emissions") +
  theme(axis.text = element_text(size = 12), 
        axis.text.x = element_text(angle = 45, 
                                   vjust = 1.2, 
                                   hjust = 1.2),
        axis.title = element_text(size = 14), 
        legend.text = element_text(size = 14),
        ) +
  scale_x_continuous(expand = c(0, 0), 
                     limits=c(1994, 2022), 
                     breaks = seq(1994, 2022, 2)) + 
  scale_y_continuous(expand = c(0, 0), 
                     limits=c(345, 415), 
                     breaks = seq(350, 415, 10)) 
```

Grouping CH4 10 year averages
`Unnecessary. Just use the BigDays.sfdfT object.`
```{r}
CH4 <- BigDays.sfdfT[,-80]%>%
  group_by(Year) %>%
  summarize(CH4_10yr = max(CH4_10year))

```

CH4 10 year averages trend
```{r}
ggplot(CH4)+# Change this!
# ggplot(BigDays.sfdfT) +
  geom_line(aes(x=Year, y= CH4_10yr), color="midnightblue",linewidth=1 )+
  theme_bw()+
  xlab("Year")+
  ylab("10-Year average CH4 Emissions [ppb]")+
  scale_x_continuous(expand=c(0,0), limits=c(1994, 2022), breaks=seq(1994,2022,2))+
  scale_y_continuous(expand=c(0,0), limits=c(1720,1880), breaks=seq(1720,1880, 20))

```

Grouping O3 10 year averages
`Unnecessary. Just use the BigDays.sfdfT object.`
```{r}
O3 <- BigDays.sfdfT[,-80] %>%
  group_by(Year) %>%
  summarize(O3_10yr=max(O3_10year))

```

O3 10-year averages trend
```{r}
ggplot(O3)+# Change this!
# ggplot(BigDays.sfdfT) +
  geom_line(aes(x=Year, y= O3_10yr), color="lemonchiffon4",linewidth=1 )+
  theme_bw()+
  xlab("Year")+
  ylab("10-Year average O3 Emissions [DU]")+
  scale_x_continuous(expand=c(0,0), limits=c(1994, 2022), breaks=seq(1994,2022,2))+
  scale_y_continuous(expand=c(0,0), limits=c(90,150), breaks=seq(90,150, 20))
  
```

Grouping AGGI 10 year averages
`Unnecessary. Just use the BigDays.sfdfT object.`
```{r}
AGGI <- BigDays.sfdfT[,-80]%>%
  group_by(Year) %>%
  summarize(AGGI_10yr=max(AGGI_10year))
```

AGGI 10-year averages trend
```{r}
ggplot(AGGI)+# Change this!
# ggplot(BigDays.sfdfT) +
  geom_line(aes(x=Year, y= AGGI_10yr), color="goldenrod1",linewidth=1 )+
  ggtitle("Ten year Average of \n Annual Greenhouse Gas Index (AGGI)")+
  theme_bw()+
  theme(plot.title=element_text(hjust=0.5))+
  xlab("Year")+
  ylab("10-Year average AGGI Emissions")+
  scale_x_continuous(expand=c(0,0), limits=c(1994, 2022), breaks=seq(1994,2022,2))+
  scale_y_continuous(expand=c(0,0), limits=c(0.5,2), breaks=seq(0.5,2,0.1))
  
```

`Make a 2x2 panel of the 10-year averages and a 2x2 panel of the 5-year averages. They may not be included in the paper, but you should still look at them.`

Seasonal Change in Tornado Outbreaks

Spatial Density by Month
Needs:
-Filter data for each month
-Calculate the total number of outbreaks per month
-create a figure for each month similar to the total outbreaks map
-Comment on which ones are the most dense and where

Relationship between GHG Emission and Total Number of Outbreaks

Correlation Matrix TABLE between GHG and Total Number of Outbreaks
Needs for all four: 
-Tests for correlation
-Tests for Significance
```{r}
#attempting correlation matrix
Outbreaks <- BigDays.sfdfT%>%
  dplyr::select(Year,CO2_1year,CH4_1year,O3_1year,AGGI_1year) 
Outbreaks<-st_drop_geometry(Outbreaks)
cor(Outbreaks)

```

`Try this: `
```{r}
test_1yr <- BigDays.sfdfT %>%
  group_by(Year) %>%
  summarize(numClus = n(), #Total number of clusters
            avgTorn = mean(nT), #Average number of outbreak tornadoes per year
            totTorn = sum(nT), #Total number of outbreak tornadoes per year
            totCas = sum(GroupDayCas), #Total number of casualties by year
            CO2_1year = max(CO2_1year),
            CH4_1year = max(CH4_1year),
            O3_1year = max(O3_1year),
            AGGI_1year = max(AGGI_1year)) %>%
  st_drop_geometry()

cor(test_1yr) 
```
`You should do this for 5-year and 10-year as well.`

Line Graph for total outbreaks and all four variables
Needs:
-Use data for everything from 1994 to 2022
`Great Job!`
```{r}
#attempting to start this
GHG_Out <-BigDays.sfdfT%>%
  group_by(Year)%>%
  summarize(Avg1_CO2=mean(CO2_1year),
            Avg5_CO2=mean(CO2_5year),
            Avg10_CO2=mean(CO2_10year), 
            T_Year=n())

```

1 Year Averages CO2 and Outbreak Relationship
`Remember to keep your colors consistent per variable in all figures.`
```{r}
#Not this one: 
#ggplot(GHG_Out)+
#  geom_bar(aes(x=Year, y=(Avg1_CO2)), stat= "identity",fill="lightblue", linewidth=1)+
#  geom_line(aes(x=Year, y=T_Year*8), stat="identity", color="blue", linewidth=1)+
  #Remove this: stat_smooth(aes(x=Year,y=T_Year*8),method = "lm", formula = y~x, geom="smooth", color="black", linewidth=1.5)+
#  theme_bw()+
#  scale_x_continuous(expand = c(0,0),limits=c(1994,2022), breaks=seq(1994,2022,2))+
#   scale_y_continuous(expand = c(0, 0), limits=c(0, 415), breaks = seq(0,415, 50), sec.axis = sec_axis(~./8, name = "Total Tornado Outbreaks"))



ggplot(GHG_Out)+
  geom_line(aes(x=Year, y=(Avg1_CO2)), stat= "identity",color="lightblue", linewidth=1)+
  geom_bar(aes(x=Year, y=T_Year*8), stat="identity", fill="blue", linewidth=1)+
  #Remove this: stat_smooth(aes(x=Year,y=T_Year*8),method = "lm", formula = y~x, geom="smooth", color="black", linewidth=1.5)+
  theme_bw()+
  scale_x_continuous(expand = c(0,0),limits=c(1994,2022), breaks=seq(1994,2022,2))+
   scale_y_continuous(expand = c(0, 0), limits=c(0, 415), breaks = seq(0,415, 50), sec.axis = sec_axis(~./8, name = "Total Tornado Outbreaks"))#Change the left y-axis label
  

```
*Both have positive regressions, but T-outbreaks is a lot slower*

5 year averages CO2 and Tornado Outbreaks
```{r}
#Not this one!
#ggplot(GHG_Out)+
#  geom_bar(aes(x=Year, y=(Avg5_CO2)), stat= "identity",fill="lightblue", linewidth=1)+
#  geom_line(aes(x=Year, y=T_Year*8), stat="identity", color="blue", linewidth=1)+
#  stat_smooth(aes(x=Year,y=T_Year*8),method = "lm", formula = y~x, geom="smooth", color="black", linewidth=1.5)+
#  theme_bw()+
#  scale_x_continuous(expand = c(0,0),limits=c(1994,2022), breaks=seq(1994,2022,2))+
#   scale_y_continuous(expand = c(0, 0), limits=c(0, 415), breaks = seq(0,415, 50), sec.axis = sec_axis(~./8, name = "Total Tornado Outbreaks"))

ggplot(GHG_Out)+
  geom_line(aes(x=Year, y=(Avg5_CO2)), stat= "identity",color="lightblue", linewidth=1)+
  geom_bar(aes(x=Year, y=T_Year*8), stat="identity", fill="blue", linewidth=1)+
  #Remove this: stat_smooth(aes(x=Year,y=T_Year*8),method = "lm", formula = y~x, geom="smooth", color="black", linewidth=1.5)+
  theme_bw()+
  scale_x_continuous(expand = c(0,0),limits=c(1994,2022), breaks=seq(1994,2022,5))+
   scale_y_continuous(expand = c(0, 0), limits=c(0, 415), breaks = seq(0,415, 50), sec.axis = sec_axis(~./8, name = "Total Tornado Outbreaks")) #Change the left y-axis label

```
 
10 year averages CO2 and Tornado Outbreaks
```{r}
#Not this one:
#ggplot(GHG_Out)+
#  geom_bar(aes(x=Year, y=(Avg10_CO2)), stat= "identity",fill="lightblue", linewidth=1)+
#  geom_line(aes(x=Year, y=T_Year*8), stat="identity", color="blue", linewidth=1)+
#  stat_smooth(aes(x=Year,y=T_Year*8),method = "lm", formula = y~x, geom="smooth", color="black", linewidth=1.5)+
#  theme_bw()+
#  scale_x_continuous(expand = c(0,0),limits=c(1994,2022), breaks=seq(1994,2022,2))+
#   scale_y_continuous(expand = c(0, 0), limits=c(0, 415), breaks = seq(0,415, 50), sec.axis = sec_axis(~./8, name = "Total Tornado Outbreaks"))

ggplot(GHG_Out)+
  geom_line(aes(x=Year, y=(Avg10_CO2)), stat= "identity",color="lightblue", linewidth=1)+
  geom_bar(aes(x=Year, y=T_Year*8), stat="identity", fill="blue", linewidth=1)+
  #Remove this: stat_smooth(aes(x=Year,y=T_Year*8),method = "lm", formula = y~x, geom="smooth", color="black", linewidth=1.5)+
  theme_bw()+
  scale_x_continuous(expand = c(0,0),limits=c(1994,2022), breaks=seq(1994,2022,5))+
   scale_y_continuous(expand = c(0, 0), limits=c(0, 415), breaks = seq(0,415, 50), sec.axis = sec_axis(~./8, name = "Total Tornado Outbreaks")) #Change the left y-axis label
```

`You can do the same for all GHG variables. You can also do all of that again for the total number of casualties (This will help with significance/importance of your paper.) and average number of tornadoes per outbreak by year. I know this is a lot of figures, but this is how you need to do trend analysis to see what the data is showing you.`
