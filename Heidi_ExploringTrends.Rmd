---
title: "Heidi_ExploringTrends"
author: "Heidi Erfourth and Zoe Schroder"
date: "2023-07-25"
output: html_document
editor_options: 
  chunk_output_type: console
---

“Exploring trends in tornado outbreak environments and greenhouse gas concentrations” 

`Pursue publication:` International Journal of Climatology
                      https://mc.manuscriptcentral.com/joc 

**Make sure to follow the Author Resources for publication in the Journal. This includes page formatting, section headers, figure format, table format, figure/table location in manuscript, etc.**

```{r}
library("dplyr")
library("ggplot2")
library("tmap")
library("USAboundaries")
library("sf")
library("gridExtra")
```

DATA & METHODS
```{r}
load("TornadoOutbreaks.RData")
```

##Tornado Data
**  Needs (numbers for table): 
** 1. Number of Days
** 2. Number of Groups
** 3. Number of Tornadoes
** 4. Number of Casualties

##Create a figure (Map) with multiple clusters on a single day
Finding a Single Day with Multiple Clusters 
```{r}
BigDays.sfdfT %>% # Cluster Data
  group_by(cDate) %>% # Group by the convective days to see if there are duplicates.
  summarize(num_of_clusters = n()) %>% # Count the number of clusters on each cDate.
  arrange(desc(num_of_clusters)) # Arrange the number of clusters column in descending order.
```

Data from June 4, 1999 Outbreak
```{r}
#Group Number: 1686, 1688

#Cluster 1 Data
June4<-BigDays.sfdfT%>%
  dplyr::filter(ID=="199906041686")

June4cent <-BigDayCentroids.df %>%
  dplyr::filter(ID=="199906041686")

June4Torns <- BigDayTornadoes%>%
  dplyr::filter(ID=="199906041686")

#Cluster 2 Data
June4_1<-BigDays.sfdfT%>%
  dplyr::filter(ID=="199906041688")

June4_1cent <-BigDayCentroids.df %>%
  dplyr::filter(ID=="199906041688")

June4_1Torns <- BigDayTornadoes%>%
  dplyr::filter(ID=="199906041688")

#Combining Cluster Data
June <- rbind(June4, June4_1)#Overall Data 
Junecent <- rbind(June4cent, June4_1cent)#Centroids
JuneTorns <- rbind(June4Torns, June4_1Torns)#Tornadoes


```
 
State Boarders for Contiguous United States 
```{r}
sts <- state.name[!state.name %in% c("Alaska", "Hawaii")] #Removes AK and HI from list of states
stateBorders <- us_states(states = sts) 
```

**Plotting June 4, 1999 Outbreak Data (Convective Day: 6 am 27th to 6 am 28th)**
```{r}
#Creating Map Projection
tm_shape(stateBorders,
          projection = "+proj=merc +lon_0=0 +k=1 +x_0=0 +y_0=0 +ellps=WGS84 +datum=WGS84 +units=m
          +no_defs")+
  
  #Formatting Borders
  tm_borders(col ="gray", 
             alpha = 1)+
  
  #Compass and Scale Bar Formatting
  tm_compass(text.size = 0.7, 
             lwd = 2, 
             color.dark = "gray")+
  tm_scale_bar(width = 0.27, 
               text.size = 0.6, 
               lwd = 1.75,  
               color.dark = "gray")+
  
  #Formatting Plot 
  tm_layout(legend.position = c(0.01,0),
            attr.position=c("right","bottom"), 
            inner.margins = c(0.3,0.2,0.3,0.2), 
            title="June 4, 1999", 
            title.position = c(0.40, 0.95))+
  
#Creating Polygons for Clusters
tm_shape(June, 
         is.master = TRUE, 
         projection = "+proj=merc +lon_0=0 +k=1 +x_0=0 +y_0=0 +ellps=WGS84 +datum=WGS84 
         +units=m +no_defs" )+
  
  #Formatting Polygons
  tm_polygons(alpha = 0, 
              border.col = "black", 
              lwd = 1.5)+

#Plotting Individual Tornadoes
tm_shape(JuneTorns, 
         projection = "+proj=merc +lon_0=0 +k=1 +x_0=0 +y_0=0 +ellps=WGS84 +datum=WGS84
         +units=m +no_defs" )+
  
  #Formatting Tornado Bubbles
  tm_bubbles(size = 0.2,
             border.lwd=NA, 
             palette = "Reds", 
             col="mag",
             breaks=seq(0,6,by=1),
             labels=c("F0", "F1","F2", "F3", "F4", "F5"),
             title.col="Magntiude")+
  
#Plotting Centroids
tm_shape(Junecent,
         is.master=TRUE,
         projection = "+proj=merc +lon_0=0 +k=1 +x_0=0 +y_0=0 +ellps=WGS84 +datum=WGS84
         +units=m +no_defs" )+
  
  #Formatting Centroids
  tm_symbols(size = 1.25, 
             col="black", 
             shape=24)

```


**Greenhouse Gas Emissions Data**
```{r}
AnnGHG <- read.csv("AnnualAverages_GHG.csv")
```

Fixing the Typo in Excel File Zero to O
```{r}
colnames(AnnGHG)[colnames(AnnGHG) == "N20_ppb"] = "N2O_ppb"
```

Calculating the Average Emissions per Year (for Table)
```{r}
AnnGHG %>%
  group_by(year) %>%
  summarize(avgCO2 = mean(CO2_ppm, 
                          na.rm = TRUE),
            avgCH4 = mean(CH4_ppb, 
                          na.rm = TRUE), 
            avgSF6 = mean(SF6_ppt, 
                          na.rm=TRUE), 
            avgN2O =mean(N2O_ppb, 
                         na.rm=TRUE), 
            avgO3 =mean(O3_DU,
                        na.rm=TRUE))
```
***


RESULTS

Plotting Outbreaks for 1994-2022
```{r}
#Creating Map Projection
tm_shape(stateBorders,
         projection = "+proj=merc +lon_0=0 +k=1 +x_0=0 +y_0=0 +ellps=WGS84 +datum=WGS84
         +units=m +no_defs")+
  
  #Formatting Plot
  tm_borders(col ="gray", 
             alpha = 1)+
  tm_layout(title="Tornado Outbreaks from 1994-2022",
            title.position = c(0.3, 0.95),
            inner.margins = c(0.1,0.1,0.1,0.1))+
  
  #Formatting Compass & Scale Bar
  tm_compass(text.size = 0.7, 
             lwd = 2, 
             color.dark = "gray",
             position = c(0,0.2))+
  tm_scale_bar(width = 0.27, 
               text.size = 0.6,
               lwd = 1.75, 
               color.dark = "gray", 
               position = c(0.01,0))+
  
  
#Plotting Individual Clusters Using Centroids
tm_shape(BigDayCentroids.df, 
         projection = "+proj=merc +lon_0=0 +k=1 +x_0=0 +y_0=0 +ellps=WGS84 +datum=WGS84 
         +units=m +no_defs" )+
  
  #Formatting Centroids
  tm_bubbles(size = 0.1,
             border.lwd=NA, 
             col = "orange3")
``` 

##Annual Change in Tornado Outbreaks

Grouping Total Number of Outbreaks per Year
```{r}
T_yr <- BigDays.sfdfT%>% 
  group_by(Year)%>%
  summarize(T_Year = n())
```

Graphing Total Outbreaks per Year
```{r}
#Plotting Outbreaks
ggplot(T_yr,
       aes(x=Year, y=T_Year))+
  
  #Line Graph
  geom_line(stat="identity", 
            color="orange3", 
            linewidth=1)+
  
  #Creating Linear Regression Line
  stat_smooth(method = "lm", 
              formula = y~x, 
              geom="smooth", 
              color="black", 
              linewidth=1)+
  
  #Plot Formatting
  ggtitle("Total Tornado Outbreaks Per Year")+
  theme_bw()+
  theme(plot.title=element_text(hjust=0.5), 
        plot.margin=margin(0.5,0.5,0.5,0.5, "cm"))+
  
  #Axes Formatting
  xlab("Year")+
  ylab("Number of Tornado Outbreaks per Year")+
  scale_x_continuous(expand = c(0,0),
                     limits=c(1994,2022),
                     breaks=seq(1994,2022,2))+
  scale_y_continuous(expand = c(0,0),
                     limits=c(20,50), 
                     breaks=seq(20,50,5))
```


##Annual Averages in GHG Emissions using BigDays_1year data

CO2 Annual Average
```{r}
#Plotting CO2 1 Year Averages 
CO2_avg <- ggplot(BigDays.sfdfT, 
                  aes(x= Year, y=CO2_1year))+
  
   #Creating a Linear Regression Line
   stat_smooth(method = "lm", 
              formula = y~x, 
              geom="smooth", 
              color="black", 
              linewidth=1)+
  
  #Line Graph
   geom_line(stat="identity", 
             color = "dodgerblue3",
             linewidth = 1)+
  
  #Formatting Plot
   theme_bw()+
  
  #Formatting Axes
   ylab("CO2 (ppm)")+
   scale_x_continuous(expand = c(0, 0), 
                     limits=c(1993, 2022), 
                     breaks = seq(1993, 2022, 5)) + 
   scale_y_continuous(expand = c(0,0), 
                     limits=c(345, 415), 
                     breaks = seq(350, 415, 10)) 
```

CH4 Annual Average
```{r}
#Plotting CH4 Data
CH4_avg <- ggplot(BigDays.sfdfT, 
                  aes(x=Year, y = CH4_1year))+
  
  #Creating a Linear Regression Line
   stat_smooth(method = "lm", 
              formula = y~x, 
              geom="smooth", 
              color="black", 
              linewidth=1)+
  
  #Line Graph
   geom_line(stat="identity",
             color = "purple3",
             linewidth = 1)+
  
  #Formatting Plot
   theme_bw()+
  
  #Formatting Aes
   ylab("CH4 (ppb)")+
   scale_x_continuous(expand=c(0,0), 
                      limits=c(1993, 2022), 
                      breaks=seq(1993,2022,5))+
   scale_y_continuous(expand=c(0,0), 
                      limits=c(1720,1880), 
                      breaks=seq(1720,1880, 20))
```

O3 Annual Average
```{r}
#Plotting O3 Data
O3_avg<-ggplot(BigDays.sfdfT,
               aes(x=Year, y=O3_1year))+
  
  #Creating a Linear Regression Line
   stat_smooth(method = "lm", 
              formula = y~x, 
              geom="smooth", 
              color="black", 
              linewidth=1)+
  
  #Line Graph
   geom_line(stat="identity",
             color = "goldenrod3",
             linewidth = 1)+
  
  #Formatting Plot
   theme_bw()+
  
  #Formatting axes
   ylab("O3 (DU)")+
   scale_x_continuous(expand=c(0,0), 
                      limits=c(1993, 2022), 
                      breaks=seq(1993,2022,5))+
   scale_y_continuous(expand=c(0,0), 
                      limits=c(90,175), 
                      breaks=seq(90,175, 20))
```

AGGI Annual Average
```{r}
#Plotting AGGI Data
AGGI_avg<- ggplot(BigDays.sfdfT,
                  aes(x=Year, y=AGGI_1year))+
  
  #Creating a Linear Regression Line
   stat_smooth(method = "lm", 
              formula = y~x, 
              geom="smooth", 
              color="black", 
              linewidth=1)+
  
  #Line Graph
   geom_line(stat="identity", 
             color = "green4",
             linewidth = 1)+
  
  #Formatting plot
   theme_bw()+
  
  #Formatting Axes
   ylab("AGGI")+
   scale_x_continuous(expand=c(0,0), 
                      limits=c(1993, 2022), 
                      breaks=seq(1993,2022,5))+
   scale_y_continuous(expand=c(0,0), 
                      limits=c(0.5,2),
                      breaks=seq(0.5,2,0.2))
```

4x4 Grid Annual Averages
```{r}
grid.arrange(CO2_avg, CH4_avg, O3_avg, AGGI_avg, nrow=2,ncol=2, top ="Annual Averages of Greenhouse Gas Emissions")
```
  
`The figures that you did previously is for all data prior to 1994. The figures that you did in this code chunk are for 1993 to 2021 (1-year prior avg so 1993 data for 1994 avg, 1994 data for 1995 avg, etc.). This is why there is a difference. For 1-year average values, you only want to look at 1993 to 2022. For 5-year average, you want 1989 to 2021. For 10-year average, you want 1983 to 2021. So, if you remove all years prior to 1993 above, the regression line flips to a positive trend. For this research, you should focus only on the values in the BigDays.sfdfT when comparing it to the tornado data.`

**10-year averages (Table)**
*The 10 year averages are already calculated for you. They are in the BigDays.sfdfT file found in the TornadoOutbreaks.RData*
**The avg for 1994 is 1984 - 1994 not inclusive. Meaning it includes the data for years January 1984 through December 1993.**

##10-Year Averages in GHG Emissions using BigDays_1year data

CO2 10-year Averages
```{r}
#Plotting CO2 Data
CO2_10 <-ggplot(BigDays.sfdfT, 
                aes(x=Year, y=CO2_10year)) +
  
  #Creating a Linear Regression Line
   stat_smooth(method = "lm", 
              formula = y~x, 
              geom="smooth", 
              color="black", 
              linewidth=1)+
  
  #Line Graph
  geom_line(stat="identity", 
            color = "dodgerblue3",
            linewidth = 1)+
  
  #Formatting Plot
  theme_bw() +
  
  #Formatting axes
  xlab("Year") +
  ylab("CO2 (ppm)") +
  scale_x_continuous(expand = c(0, 0), 
                     limits=c(1993, 2022), 
                     breaks = seq(1993, 2022, 10)) + 
  scale_y_continuous(expand = c(0, 0), 
                     limits=c(345, 415), 
                     breaks = seq(350, 415, 10)) 
```

CH4 10 year Averages
```{r}
#Plotting CH4 Data
CH4_10<-ggplot(BigDays.sfdfT, 
               aes(x=Year, y=CH4_10year)) +
  
  #Creating a Linear Regression Line
   stat_smooth(method = "lm", 
              formula = y~x, 
              geom="smooth", 
              color="black", 
              linewidth=1)+
  
  #Line Graph
  geom_line(stat="identity",
            color="purple3",
            linewidth=1 )+
  
  #Formatting Plot
  theme_bw()+
  
  #Formatting Axes
  xlab("Year")+
  ylab("CH4 (ppb)")+
  scale_x_continuous(expand=c(0,0), 
                     limits=c(1993, 2022), 
                     breaks=seq(1993,2022,10))+
  scale_y_continuous(expand=c(0,0), 
                     limits=c(1720,1880), 
                     breaks=seq(1720,1880, 20))
```

O3 10-year Averages
```{r}
#Plotting O3 Data
O3_10<-ggplot(BigDays.sfdfT, 
              aes(x=Year, y=O3_10year)) +
  
  #Creating a Linear Regression Line
   stat_smooth(method = "lm", 
              formula = y~x, 
              geom="smooth", 
              color="black", 
              linewidth=1)+
  
  #Line Graph
  geom_line(stat="identity", 
            color="goldenrod3",
            linewidth=1 )+
  
  #Formatting Plot
  theme_bw()+
  
  #Formatting Axes
  xlab("Year")+
  ylab("O3 (DU)")+
  scale_x_continuous(expand=c(0,0), 
                     limits=c(1993, 2022),
                     breaks=seq(1993,2022,10))+
  scale_y_continuous(expand=c(0,0), 
                     limits=c(90,150), 
                     breaks=seq(90,150, 20))
```

AGGI 10-year Averages
```{r}
#Plotting AGGI Data
AGGI_10<-ggplot(BigDays.sfdfT, 
                aes(x=Year, y=AGGI_10year)) +
  
  #Creating a Linear Regression Line
   stat_smooth(method = "lm", 
              formula = y~x, 
              geom="smooth", 
              color="black", 
              linewidth=1)+
  
  #Line Graph
  geom_line(stat="identity", 
            color="green4",
            linewidth=1 )+
  
  #Formatting Plot
  theme_bw()+
  
  #Formatting Axes
  xlab("Year")+
  ylab("AGGI ")+
  scale_x_continuous(expand=c(0,0), 
                     limits=c(1993, 2022), 
                     breaks=seq(1993,2022,10))+
  scale_y_continuous(expand=c(0,0), 
                     limits=c(0.5,2),
                     breaks=seq(0.5,2,0.2))
```

```{r}
grid.arrange(CO2_10, CH4_10, O3_10, AGGI_10, nrow=2, top ="10-Year Averages of Greenhouse Gas Emissions")
```


**Seasonal Change in Tornado Outbreaks**

Spatial Density by Month
Needs:
-Filter data for each month
-Calculate the total number of outbreaks per month
-create a figure for each month similar to the total outbreaks map
-Comment on which ones are the most dense and where

Relationship between GHG Emission and Total Number of Outbreaks

Correlation Matrix TABLE between GHG and Total Number of Outbreaks
Needs for all four: 
-Tests for correlation
-Tests for Significance

1 year emission correlation to tornado data
```{r}
test_1yr <- BigDays.sfdfT %>%
  group_by(Year) %>%
  summarize(numClus = n(), #Total number of clusters
            avgTorn = mean(nT), #Average number of outbreak tornadoes per year
            totTorn = sum(nT), #Total number of outbreak tornadoes per year
            totCas = sum(GroupDayCas), #Total number of casualties by year
            T_F0 = sum(n0), T_F1=sum(n1),  T_F2=sum(n2), T_F3=sum(n3), T_F4=sum(n4), T_F5=sum(n5),
            CO2_1year = max(CO2_1year),
            CH4_1year = max(CH4_1year),
            O3_1year = max(O3_1year),
            AGGI_1year = max(AGGI_1year)) %>%
  st_drop_geometry()

cor(test_1yr)
```

5 year emission correlation to tornado data
```{r}
test_5yr <- BigDays.sfdfT %>%
  group_by(Year) %>%
  summarize(numClus = n(), #Total number of clusters
            avgTorn = mean(nT), #Average number of outbreak tornadoes per year
            totTorn = sum(nT), #Total number of outbreak tornadoes per year
            totCas = sum(GroupDayCas), #Total number of casualties by year
            T_F0 = sum(n0), T_F1=sum(n1),  T_F2=sum(n2), T_F3=sum(n3), T_F4=sum(n4), T_F5=sum(n5),
            CO2_5year = max(CO2_5year),
            CH4_5year = max(CH4_5year),
            O3_5year = max(O3_5year),
            AGGI_5year = max(AGGI_5year)) %>%
  st_drop_geometry()


cor(test_5yr) 
```

10 year emission correlation to tornado data
```{r}
test_10yr <- BigDays.sfdfT %>%
  group_by(Year) %>%
  summarize(numClus = n(), #Total number of clusters
            avgTorn = mean(nT), #Average number of outbreak tornadoes per year
            totTorn = sum(nT), #Total number of outbreak tornadoes per year
            totCas = sum(GroupDayCas), #Total number of casualties by year
            T_F0 = sum(n0), T_F1=sum(n1),  T_F2=sum(n2), T_F3=sum(n3), T_F4=sum(n4), T_F5=sum(n5),
            CO2_10year = max(CO2_10year),
            CH4_10year = max(CH4_10year),
            O3_10year = max(O3_10year),
            AGGI_10year = max(AGGI_10year)) %>%
  st_drop_geometry()

cor(test_10yr) 
```

**Line Graph for total outbreaks and all four variables**
Needs:
-Use data for everything from 1994 to 2022
`Great Job!`
```{r}
#attempting to start this
GHG_Out <-BigDays.sfdfT%>%
  group_by(Year)%>%
  summarize(Avg1_CO2=mean(CO2_1year), Avg5_CO2=mean(CO2_5year), Avg10_CO2=mean(CO2_10year),
            Avg1_CH4=mean(CH4_1year), Avg5_CH4=mean(CH4_5year), Avg10_CH4=mean(CH4_10year),
            Avg1_O3=mean(O3_1year), Avg5_O3=mean(O3_5year), Avg10_O3=mean(O3_10year),
            Avg1_AGGI=mean(AGGI_1year), Avg5_AGGI=mean(AGGI_5year), Avg10_AGGI=mean(AGGI_10year),
            T_Year=n(),
            T_avgyear = mean(nT),
            T_FO = mean(n0), T_F1= mean(n1), T_F2 = mean(n2),T_F3 = mean(n3), T_F4 = mean(n4), T_F5 = mean(n5),
            T_Cas = sum(GroupDayCas))


```

##CO2 Trend Analysis with Total Tornado Outbreaks
1 Year Averages CO2 and Outbreak Relationship
```{r}
ggplot(GHG_Out)+
  geom_line(aes(x=Year, y=(Avg1_CO2)), stat= "identity",color="dodgerblue3", linewidth=1)+
  geom_bar(aes(x=Year, y=T_Year*8), stat="identity", fill="goldenrod3", linewidth=1)+
  theme_bw()+
  ylab("CO2 Emissions (ppm)")+
  scale_x_continuous(expand = c(0,0),limits=c(1994,2022), breaks=seq(1994,2022,2))+
  scale_y_continuous(expand = c(0, 0), limits=c(0, 415), breaks = seq(0,415, 50), sec.axis = sec_axis(~./8, name = "Total Tornado Outbreaks"))
  

```
*Both have positive regressions, but T-outbreaks is a lot slower*

5 year averages CO2 and Tornado Outbreaks
```{r}
ggplot(GHG_Out)+
  geom_line(aes(x=Year, y=(Avg5_CO2)), stat= "identity",color="dodgerblue3", linewidth=1)+
  geom_bar(aes(x=Year, y=T_Year*8), stat="identity", fill="goldenrod3", linewidth=1)+
  theme_bw()+
  ylab("CO2 Emissions (ppm)")+
  scale_x_continuous(expand = c(0,0),limits=c(1994,2022), breaks=seq(1994,2022,5))+
  scale_y_continuous(expand = c(0, 0), limits=c(0, 415), breaks = seq(0,415, 50), sec.axis = sec_axis(~./8, name = "Total Tornado Outbreaks"))

```
 
10 year averages CO2 and Tornado Outbreaks
```{r}
ggplot(GHG_Out)+
  geom_line(aes(x=Year, y=(Avg10_CO2)), stat= "identity",color="dodgerblue3", linewidth=1)+
  geom_bar(aes(x=Year, y=T_Year*8), stat="identity", fill="goldenrod3", linewidth=1)+
  theme_bw()+
  ylab("CO2 Emissions (ppm)")+
  scale_x_continuous(expand = c(0,0),limits=c(1994,2022), breaks=seq(1994,2022,5))+
  scale_y_continuous(expand = c(0, 0), limits=c(0, 415), breaks = seq(0,415, 50), sec.axis = sec_axis(~./8, name = "Total Tornado Outbreaks")) 
```


##CH4 Trend Analysis with Total Tornado Outbreaks
1 Year Averages CH4 and Outbreak Relationship
```{r}
ggplot(GHG_Out)+
  geom_line(aes(x=Year, y=(Avg1_CH4)), stat= "identity",color="firebrick3", linewidth=1)+
  geom_bar(aes(x=Year, y=T_Year*25), stat="identity", fill="goldenrod3", linewidth=1)+
  theme_bw()+
  ylab("CH4 Emissions (ppb)")+
  scale_x_continuous(expand = c(0,0),limits=c(1994,2022), breaks=seq(1994,2022,2))+
  scale_y_continuous(expand = c(0, 0), limits=c(0,3000), breaks = seq(0,3000, 500), sec.axis = sec_axis(~./25, name = "Total Tornado Outbreaks"))
  

```


5 year averages CH4 and Tornado Outbreaks
```{r}
ggplot(GHG_Out)+
  geom_line(aes(x=Year, y=(Avg5_CH4)), stat= "identity",color="firebrick3", linewidth=1)+
  geom_bar(aes(x=Year, y=T_Year*25), stat="identity", fill="goldenrod3", linewidth=1)+
  theme_bw()+
  ylab("CH4 Emissions (ppb)")+
  scale_x_continuous(expand = c(0,0),limits=c(1994,2022), breaks=seq(1994,2022,5))+
  scale_y_continuous(expand = c(0, 0), limits=c(0, 3000), breaks = seq(0,3000, 500), sec.axis = sec_axis(~./25, name = "Total Tornado Outbreaks"))


```
 
10 year averages CH4 and Tornado Outbreaks
```{r}
ggplot(GHG_Out)+
  geom_line(aes(x=Year, y=(Avg10_CH4)), stat= "identity",color="firebrick3", linewidth=1)+
  geom_bar(aes(x=Year, y=T_Year*25), stat="identity", fill="goldenrod3", linewidth=1)+
  theme_bw()+
  ylab("CH4 Emissions (ppb)")+
  scale_x_continuous(expand = c(0,0),limits=c(1994,2022), breaks=seq(1994,2022,5))+
  scale_y_continuous(expand = c(0, 0), limits=c(0, 3000), breaks = seq(0,3000, 500), sec.axis = sec_axis(~./25, name = "Total Tornado Outbreaks")) 
```


##O3 Trend Analysis with Total Tornado Outbreaks
1 Year Averages O3 and Outbreak Relationship
```{r}
ggplot(GHG_Out)+
  geom_line(aes(x=Year, y=(Avg1_O3)), stat= "identity",color="darkorange3", linewidth=1)+
  geom_bar(aes(x=Year, y=T_Year/.5), stat="identity", fill="goldenrod3", linewidth=1)+
  theme_bw()+
  ylab("O3 Emissions (DU)")+
  scale_x_continuous(expand = c(0,0),limits=c(1994,2022), breaks=seq(1994,2022,2))+
  scale_y_continuous(expand = c(0, 0), limits=c(0,200), breaks = seq(0,200,20), sec.axis = sec_axis(~.*.5, name = "Total Tornado Outbreaks"))
```


5 year averages O3 and Tornado Outbreaks
```{r}
ggplot(GHG_Out)+
  geom_line(aes(x=Year, y=(Avg5_O3)), stat= "identity",color="darkorange3", linewidth=1)+
  geom_bar(aes(x=Year, y=T_Year/.5), stat="identity", fill="goldenrod3", linewidth=1)+
  theme_bw()+
  ylab("O3 Emissions (DU)")+
  scale_x_continuous(expand = c(0,0),limits=c(1994,2022), breaks=seq(1994,2022,5))+
  scale_y_continuous(expand = c(0, 0), limits=c(0, 200), breaks = seq(0,200, 20), sec.axis = sec_axis(~.*.5, name = "Total Tornado Outbreaks"))


```
 
10 year averages O3 and Tornado Outbreaks
```{r}
ggplot(GHG_Out)+
  geom_line(aes(x=Year, y=(Avg10_O3)), stat= "identity",color="darkorange3", linewidth=1)+
  geom_bar(aes(x=Year, y=T_Year/.5), stat="identity", fill="goldenrod3", linewidth=1)+
  theme_bw()+
  ylab("O3 Emission (DU)")+
  scale_x_continuous(expand = c(0,0),limits=c(1994,2022), breaks=seq(1994,2022,5))+
  scale_y_continuous(expand = c(0, 0), limits=c(0, 200), breaks = seq(0,200, 20), sec.axis = sec_axis(~.*.5, name = "Total Tornado Outbreaks")) 
```


##AGGI Trend Analysis with Total Tornado Outbreaks
1 Year Averages Aggi and Outbreak Relationship
```{r}
ggplot(GHG_Out)+
  geom_line(aes(x=Year, y=(Avg1_AGGI)), stat= "identity",color="green4", linewidth=1)+
  geom_bar(aes(x=Year, y=T_Year/25), stat="identity", fill="goldenrod3", linewidth=1)+
  theme_bw()+
  ylab("AGGI")+
  scale_x_continuous(expand = c(0,0),limits=c(1994,2022), breaks=seq(1994,2022,2))+
  scale_y_continuous(expand = c(0,0), limits=c(0,2), breaks = seq(0,2,.1), sec.axis = sec_axis(~.*25, name = "Total Tornado Outbreaks"))
```


5 year averages AGGI  and Tornado Outbreaks
```{r}
ggplot(GHG_Out)+
  geom_line(aes(x=Year, y=(Avg5_AGGI)), stat= "identity",color="green4", linewidth=1)+
  geom_bar(aes(x=Year, y=T_Year/25), stat="identity", fill="goldenrod3", linewidth=1)+
  theme_bw()+
  ylab("AGGI")+
  scale_x_continuous(expand = c(0,0),limits=c(1994,2022), breaks=seq(1994,2022,5))+
  scale_y_continuous(expand = c(0, 0), limits=c(0, 2), breaks = seq(0,2,.1), sec.axis = sec_axis(~.*25, name = "Total Tornado Outbreaks"))


```
 
10 year averages AGGI and Tornado Outbreaks
```{r}
ggplot(GHG_Out)+
  geom_line(aes(x=Year, y=(Avg10_AGGI)), stat= "identity",color="green4", linewidth=1)+
  geom_bar(aes(x=Year, y=T_Year/25), stat="identity", fill="goldenrod3", linewidth=1)+
  theme_bw()+
  ylab("AGGI")+
  scale_x_continuous(expand = c(0,0),limits=c(1994,2022), breaks=seq(1994,2022,5))+
  scale_y_continuous(expand = c(0, 0), limits=c(0, 2), breaks = seq(0,2,.5), sec.axis = sec_axis(~.*25, name = "Total Tornado Outbreaks")) 
```



`You can do the same for all GHG variables. You can also do all of that again for the total number of casualties (This will help with significance/importance of your paper.) and average number of tornadoes per outbreak by year. I know this is a lot of figures, but this is how you need to do trend analysis to see what the data is showing you.`

##C02 Trend Analysis with Total Casualties
1 year average of CO2 & Total Casualties
```{r}
ggplot(GHG_Out)+
  geom_line(aes(x=Year, y=(Avg1_CO2)), stat= "identity",color="dodgerblue3", linewidth=1)+
  geom_bar(aes(x=Year, y=T_Cas/20), stat="identity", fill="deeppink3", linewidth=1)+
  theme_bw()+
  ylab("CO2 Emissions (ppm)")+
  scale_x_continuous(expand = c(0,0),limits=c(1994,2022), breaks=seq(1994,2022,2))+
  scale_y_continuous(expand = c(0, 0), limits=c(0, 415), breaks = seq(0,415, 50), sec.axis = sec_axis(~.*20, name = "Total Casualties"))
```


5 year averages CO2 and Total Casualties
```{r}
ggplot(GHG_Out)+
  geom_line(aes(x=Year, y=(Avg5_CO2)), stat= "identity",color="dodgerblue3", linewidth=1)+
  geom_bar(aes(x=Year, y=T_Cas/20), stat="identity", fill="deeppink3", linewidth=1)+
  theme_bw()+
  ylab("CO2 Emissions (ppm)")+
  scale_x_continuous(expand = c(0,0),limits=c(1994,2022), breaks=seq(1994,2022,5))
  scale_y_continuous(expand = c(0, 0), limits=c(0, 415), breaks = seq(0,415, 50), sec.axis = sec_axis(~.*20, name = "Total Casualties")) 

```
 
10 year averages CO2 and Total Casualties
```{r}
ggplot(GHG_Out)+
  geom_line(aes(x=Year, y=(Avg10_CO2)), stat= "identity",color="dodgerblue3", linewidth=1)+
  geom_bar(aes(x=Year, y=T_Cas/20), stat="identity", fill="deeppink3", linewidth=1)+
  theme_bw()+
  ylab("CO2 Emissions (ppm)")+
  scale_x_continuous(expand = c(0,0),limits=c(1994,2022), breaks=seq(1994,2022,5))+
  scale_y_continuous(expand = c(0, 0), limits=c(0, 415), breaks = seq(0,415, 50), sec.axis = sec_axis(~.*20, name = "Total Casualties")) 
```


##CH4 Trend Analysis with Total Casualties
1 Year Averages CH4 and Total Casualties
```{r}
ggplot(GHG_Out)+
  geom_line(aes(x=Year, y=(Avg1_CH4)), stat= "identity",color="firebrick3", linewidth=1)+
  geom_bar(aes(x=Year, y=T_Cas/2), stat="identity", fill="deeppink3", linewidth=1)+
  theme_bw()+
  ylab("CH4 Emissions (ppb)")+
  scale_x_continuous(expand = c(0,0),limits=c(1994,2022), breaks=seq(1994,2022,2))+
  scale_y_continuous(expand = c(0, 0), limits=c(0,3000), breaks = seq(0,3000, 500), sec.axis = sec_axis(~.*2, name = "Total Casualties"))
  

```


5 year averages CH4 and Total Casualties
```{r}
ggplot(GHG_Out)+
  geom_line(aes(x=Year, y=(Avg5_CH4)), stat= "identity",color="firebrick3", linewidth=1)+
  geom_bar(aes(x=Year, y=T_Cas/2), stat="identity", fill="deeppink3", linewidth=1)+
  theme_bw()+
  ylab("CH4 Emissions (ppb)")+
  scale_x_continuous(expand = c(0,0),limits=c(1994,2022), breaks=seq(1994,2022,5))+
  scale_y_continuous(expand = c(0, 0), limits=c(0, 3000), breaks = seq(0,3000, 500), sec.axis = sec_axis(~.*2, name = "Total Casualties"))

```
 
10 year averages CH4 and Total Casualties
```{r}
ggplot(GHG_Out)+
  geom_line(aes(x=Year, y=(Avg10_CH4)), stat= "identity",color="firebrick3", linewidth=1)+
  geom_bar(aes(x=Year, y=T_Cas/2), stat="identity", fill="deeppink3", linewidth=1)+
  theme_bw()+
  ylab("CH4 Emissions (ppb)")+
  scale_x_continuous(expand = c(0,0),limits=c(1994,2022), breaks=seq(1994,2022,5))+
  scale_y_continuous(expand = c(0, 0), limits=c(0, 3000), breaks = seq(0,3000, 500), sec.axis = sec_axis(~.*2, name = "Total Casualties")) 
```


##O3 Trend Analysis with Total Casualties
1 Year Averages O3 and Total Casualties
```{r}
ggplot(GHG_Out)+
  geom_line(aes(x=Year, y=(Avg1_O3)), stat= "identity",color="darkorange3", linewidth=1)+
  geom_bar(aes(x=Year, y=T_Cas/30), stat="identity", fill="deeppink3", linewidth=1)+
  theme_bw()+
  ylab("O3 Emissions (DU)")+
  scale_x_continuous(expand = c(0,0),limits=c(1994,2022), breaks=seq(1994,2022,2))+
  scale_y_continuous(expand = c(0, 0), limits=c(0,200), breaks = seq(0,200,20), sec.axis = sec_axis(~.*30, name = "Total Casualties"))
```


5 year averages O3 and Tornado Casualties
```{r}
ggplot(GHG_Out)+
  geom_line(aes(x=Year, y=(Avg5_O3)), stat= "identity",color="darkorange3", linewidth=1)+
  geom_bar(aes(x=Year, y=T_Cas/30), stat="identity", fill="deeppink3", linewidth=1)+
  theme_bw()+
  ylab("O3 Emissions (DU)")+
  scale_x_continuous(expand = c(0,0),limits=c(1994,2022), breaks=seq(1994,2022,5))+
  scale_y_continuous(expand = c(0, 0), limits=c(0, 200), breaks = seq(0,200, 20), sec.axis = sec_axis(~.*30, name = "Total Casulties"))
```

10 year averages O3 and Tornado Casualties
```{r}
ggplot(GHG_Out)+
  geom_line(aes(x=Year, y=(Avg10_O3)), stat= "identity",color="darkorange3", linewidth=1)+
  geom_bar(aes(x=Year, y=T_Cas/30), stat="identity", fill="deeppink3", linewidth=1)+
  theme_bw()+
  ylab("O3 Emission (DU)")+
  scale_x_continuous(expand = c(0,0),limits=c(1994,2022), breaks=seq(1994,2022,5))+
  scale_y_continuous(expand = c(0, 0), limits=c(0, 200), breaks = seq(0,200, 20), sec.axis = sec_axis(~.*30, name = "Total Casualties")) 
```


##AGGI Trend Analysis with Total Casualties
1 Year Averages AGGI and Total Casualties
```{r}
ggplot(GHG_Out)+
  geom_line(aes(x=Year, y=(Avg1_AGGI)), stat= "identity",color="green4", linewidth=1)+
  geom_bar(aes(x=Year, y=T_Cas/4000), stat="identity", fill="deeppink3", linewidth=1)+
  theme_bw()+
  ylab("AGGI")+
  scale_x_continuous(expand = c(0,0),limits=c(1994,2022), breaks=seq(1994,2022,2))+
  scale_y_continuous(expand = c(0,0), limits=c(0,2), breaks = seq(0,2,.1), sec.axis = sec_axis(~.*4000, name = "Total Casualties"))
```

5 year averages AGGI  and Total Casualties
```{r}
ggplot(GHG_Out)+
  geom_line(aes(x=Year, y=(Avg5_AGGI)), stat= "identity",color="green4", linewidth=1)+
  geom_bar(aes(x=Year, y=T_Cas/4000), stat="identity", fill="deeppink3", linewidth=1)+
  theme_bw()+
  ylab("AGGI")+
  scale_x_continuous(expand = c(0,0),limits=c(1994,2022), breaks=seq(1994,2022,5))+
  scale_y_continuous(expand = c(0, 0), limits=c(0, 2), breaks = seq(0,2,.1), sec.axis = sec_axis(~.*4000, name = "Total Casualties"))


```
 
10 year averages AGGI and Total Casualties
```{r}
ggplot(GHG_Out)+
  geom_line(aes(x=Year, y=(Avg10_AGGI)), stat= "identity",color="green4", linewidth=1)+
  geom_bar(aes(x=Year, y=T_Cas/4000), stat="identity", fill="deeppink3", linewidth=1)+
  theme_bw()+
  ylab("AGGI")+
  scale_x_continuous(expand = c(0,0),limits=c(1994,2022), breaks=seq(1994,2022,5))+
  scale_y_continuous(expand = c(0, 0), limits=c(0, 2), breaks = seq(0,2,.5), sec.axis = sec_axis(~.*4000, name = "Total Casualties"))
```

##C02 Trend Analysis with Avg Tornadoes per year 
1 year average of CO2 & Avg T per year
```{r}
ggplot(GHG_Out)+
  geom_line(aes(x=Year, y=(Avg1_CO2)), stat= "identity",color="dodgerblue3", linewidth=1)+
  geom_bar(aes(x=Year, y=T_avgyear*10), stat="identity", fill="purple1", linewidth=1)+
  theme_bw()+
  ylab("CO2 Emissions (ppm)")+
  scale_x_continuous(expand = c(0,0),limits=c(1994,2022), breaks=seq(1994,2022,2))+
  scale_y_continuous(expand = c(0, 0), limits=c(0, 415), breaks = seq(0,415, 50), sec.axis = sec_axis(~./10, name = "Average Tornadoes per year"))
```


5 year averages CO2 and Avg T per year
```{r}
ggplot(GHG_Out)+
  geom_line(aes(x=Year, y=(Avg5_CO2)), stat= "identity",color="dodgerblue3", linewidth=1)+
  geom_bar(aes(x=Year, y=T_avgyear*10), stat="identity", fill="purple1", linewidth=1)+
  theme_bw()+
  ylab("CO2 Emissions (ppm)")+
  scale_x_continuous(expand = c(0,0),limits=c(1994,2022), breaks=seq(1994,2022,5))+
  scale_y_continuous(expand = c(0, 0), limits=c(0, 415), breaks = seq(0,415, 50), sec.axis = sec_axis(~./10, name = "Average Tornadoes per year")) 

```
 
10 year averages CO2 and Avg T per year 
```{r}
ggplot(GHG_Out)+
  geom_line(aes(x=Year, y=(Avg10_CO2)), stat= "identity",color="dodgerblue3", linewidth=1)+
  geom_bar(aes(x=Year, y=T_avgyear*10), stat="identity", fill="purple1", linewidth=1)+
  theme_bw()+
  ylab("CO2 Emissions (ppm)")+
  scale_x_continuous(expand = c(0,0),limits=c(1994,2022), breaks=seq(1994,2022,5))+
  scale_y_continuous(expand = c(0, 0), limits=c(0, 415), breaks = seq(0,415, 50), sec.axis = sec_axis(~./10, name = "Average Tornadoes per year")) 
```


##CH4 Trend Analysis with avg T per year
1 Year Averages CH4 and avg T per year
```{r}
ggplot(GHG_Out)+
  geom_line(aes(x=Year, y=(Avg1_CH4)), stat= "identity",color="firebrick3", linewidth=1)+
  geom_bar(aes(x=Year, y=T_avgyear*50), stat="identity", fill="purple1", linewidth=1)+
  theme_bw()+
  ylab("CH4 Emissions (ppb)")+
  scale_x_continuous(expand = c(0,0),limits=c(1994,2022), breaks=seq(1994,2022,2))+
  scale_y_continuous(expand = c(0, 0), limits=c(0,3000), breaks = seq(0,3000, 500), sec.axis = sec_axis(~./50,name="Average Tornadoes per year"))
  

```


5 year averages CH4 and avg T per year
```{r}
ggplot(GHG_Out)+
  geom_line(aes(x=Year, y=(Avg5_CH4)), stat= "identity",color="firebrick3", linewidth=1)+
  geom_bar(aes(x=Year, y=T_avgyear*50), stat="identity", fill="purple1", linewidth=1)+
  theme_bw()+
  ylab("CH4 Emissions (ppb)")+
  scale_x_continuous(expand = c(0,0),limits=c(1994,2022), breaks=seq(1994,2022,5))+
  scale_y_continuous(expand = c(0, 0), limits=c(0, 3000), breaks = seq(0,3000, 500), sec.axis = sec_axis(~./50, name = "Average Tornadoes per year"))

```
 
10 year averages CH4 and avg T per year
```{r}
ggplot(GHG_Out)+
  geom_line(aes(x=Year, y=(Avg10_CH4)), stat= "identity",color="firebrick3", linewidth=1)+
  geom_bar(aes(x=Year, y=T_avgyear*50), stat="identity", fill="purple1", linewidth=1)+
  theme_bw()+
  ylab("CH4 Emissions (ppb)")+
  scale_x_continuous(expand = c(0,0),limits=c(1994,2022), breaks=seq(1994,2022,5))+
  scale_y_continuous(expand = c(0, 0), limits=c(0, 3000), breaks = seq(0,3000, 500), sec.axis = sec_axis(~./50, name = "Average Tornadoes per year")) 
```


##O3 Trend Analysis with Avg T per year
1 Year Averages O3 and avg T per year
```{r}
ggplot(GHG_Out)+
  geom_line(aes(x=Year, y=(Avg1_O3)), stat= "identity",color="darkorange3", linewidth=1)+
  geom_bar(aes(x=Year, y=T_avgyear*3), stat="identity", fill="purple1", linewidth=1)+
  theme_bw()+
  ylab("O3 Emissions (DU)")+
  scale_x_continuous(expand = c(0,0),limits=c(1994,2022), breaks=seq(1994,2022,2))+
  scale_y_continuous(expand = c(0, 0), limits=c(0,200), breaks = seq(0,200,20), sec.axis = sec_axis(~./3, name = "Average  Tornadoes per year"))
```


5 year averages O3 and avg T per year
```{r}
ggplot(GHG_Out)+
  geom_line(aes(x=Year, y=(Avg5_O3)), stat= "identity",color="darkorange3", linewidth=1)+
  geom_bar(aes(x=Year, y=T_avgyear*3), stat="identity", fill="purple1", linewidth=1)+
  theme_bw()+
  ylab("O3 Emissions (DU)")+
  scale_x_continuous(expand = c(0,0),limits=c(1994,2022), breaks=seq(1994,2022,5))+
  scale_y_continuous(expand = c(0, 0), limits=c(0, 200), breaks = seq(0,200, 20), sec.axis = sec_axis(~./3, name = "Average Tornadoes per year"))
```

10 year averages O3 and avg T per year
```{r}
ggplot(GHG_Out)+
  geom_line(aes(x=Year, y=(Avg10_O3)), stat= "identity",color="darkorange3", linewidth=1)+
  geom_bar(aes(x=Year, y=T_avgyear*3), stat="identity", fill="purple1", linewidth=1)+
  theme_bw()+
  ylab("O3 Emission (DU)")+
  scale_x_continuous(expand = c(0,0),limits=c(1994,2022), breaks=seq(1994,2022,5))+
  scale_y_continuous(expand = c(0, 0), limits=c(0, 200), breaks = seq(0,200, 20), sec.axis = sec_axis(~./3, name = "Average Tornadoes per year")) 
```


##AGGI Trend Analysis with avg T per year
1 Year Averages AGGI and avg T per year
```{r}
ggplot(GHG_Out)+
  geom_line(aes(x=Year, y=(Avg1_AGGI)), stat= "identity",color="green4", linewidth=1)+
  geom_bar(aes(x=Year, y=T_avgyear/30), stat="identity", fill="purple1", linewidth=1)+
  theme_bw()+
  ylab("AGGI")+
  scale_x_continuous(expand = c(0,0),limits=c(1994,2022), breaks=seq(1994,2022,2))+
  scale_y_continuous(expand = c(0,0), limits=c(0,2), breaks = seq(0,2,.1), sec.axis = sec_axis(~.*30, name = "Average Tornadoes per year"))
```

5 year averages AGGI  and avg T per year
```{r}
ggplot(GHG_Out)+
  geom_line(aes(x=Year, y=(Avg5_AGGI)), stat= "identity",color="green4", linewidth=1)+
  geom_bar(aes(x=Year, y=T_avgyear/30), stat="identity", fill="purple1", linewidth=1)+
  theme_bw()+
  ylab("AGGI")+
  scale_x_continuous(expand = c(0,0),limits=c(1994,2022), breaks=seq(1994,2022,5))+
  scale_y_continuous(expand = c(0, 0), limits=c(0, 2), breaks = seq(0,2,.1), sec.axis = sec_axis(~.*30, name = "Average Tornadoes per year"))


```
 
10 year averages AGGI and avg T per year
```{r}
ggplot(GHG_Out)+
  geom_line(aes(x=Year, y=(Avg10_AGGI)), stat= "identity",color="green4", linewidth=1)+
  geom_bar(aes(x=Year, y=T_avgyear/30), stat="identity", fill="purple1", linewidth=1)+
  theme_bw()+
  ylab("AGGI")+
  scale_x_continuous(expand = c(0,0),limits=c(1994,2022), breaks=seq(1994,2022,5))+
  scale_y_continuous(expand = c(0, 0), limits=c(0, 2), breaks = seq(0,2,.5), sec.axis = sec_axis(~.*30, name = "Average Tornadoes per year"))
```

